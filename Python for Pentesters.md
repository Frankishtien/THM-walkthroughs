# Python for Pentesters


<img width="1904" height="398" alt="image" src="https://github.com/user-attachments/assets/7c35463d-cd36-45c4-ab9b-83bdfe95c674" />


---


<details>
  <summary>Introduction</summary>



> ## Notice: A wordlist that will be useful to complete tasks related to the target system associated with this room can be found attached to the next task. The wordlist was also added to the AttackBox and is located in the following path /usr/share/wordlists/PythonForPentesters/wordlist2.txt


<img width="902" height="260" alt="image" src="https://github.com/user-attachments/assets/9b348cde-fab8-4501-b6aa-7d86c3130dd0" />




  
</details>



<details>
  <summary>Subdomain Enumeration</summary>


```python
import requests
import sys


sub_list= open("subdomains.txt").read()
subdoms=sub_list.splitlines()

for sub in subdoms :
    subdomains= f"http://{sub}.{sys.argv[1]}"
    
    try:
        requests.get(subdomains)
    except requests.ConnectionError :
        pass
        
        
    else:
        print("Valid domain: ",subdomains)

```


- **`subdoms=sub_list.splitlines()`** : He divides the words that are read line by line, Each line remains an item in the list
- **`http://{sub}.{sys.argv[1]}`** : it take domain when you run code like `python script.py google.com`
- **`try : requests.get(subdomains)`** : Send a Request to the site | If the site exists → it will be normal  | If it is not there → an error will appear
- **`except requests.ConnectionError :`** : If a connection error occurs (the site is not found) | It ignores and does not complete printing







<img width="1544" height="341" alt="image" src="https://github.com/user-attachments/assets/9d372fb0-be25-48f5-a273-03be259cca19" />


  
</details>






<details>
  <summary>Directory Enumeration</summary>






```python
import requests
import sys


dir_names = open("directorys_names.txt").read()
directorys = dir_names.splitlines()


for dir in directorys:
    dirs = f"http://{sys.argv[1]}/{dir}.html"
    r = requests.get(dirs)
    
    if r.status_code == 404:
        pass
    else:
        print("Valid Directory: ",dirs)

```

```
python3 dirs.py 10.114.169.137
```




<img width="782" height="163" alt="image" src="https://github.com/user-attachments/assets/7bf516c7-a692-439e-82b0-e1ef0b86fde3" />

<img width="1394" height="543" alt="image" src="https://github.com/user-attachments/assets/e132933b-8832-4b80-8006-98da324b5000" />

<img width="1263" height="693" alt="image" src="https://github.com/user-attachments/assets/f0c2501f-04d6-440c-951c-49ee12fb99b3" />

<img width="1351" height="213" alt="image" src="https://github.com/user-attachments/assets/b9b0bb16-ae8d-45b2-af90-784d27f0f7ef" />



  
</details>







<details>
  <summary>Network Scanner</summary>



```python
from scapy.all import *

interface = "eth0"
ip_range = "10.10.X.X/24"
broadcastMac = "ff:ff:ff:ff:ff:ff"

packet = Ether(dst=broadcastMac)/ARP(pdst = ip_range) 

ans, unans = srp(packet, timeout =2, iface=interface, inter=0.1)

for send,receive in ans:
        print (receive.sprintf(r"%Ether.src% - %ARP.psrc%"))     
```




Create the packet
-------------

packet = Ether(dst=broadcastMac)/ARP(pdst=ip_range)

Here he makes a Packet consisting of:

- Ether → determines that it will track Broadcast

- ARP → Ask:\
    “Who owns this IP? Give me your MAC.”

This means that it says to all devices:

>Whoever has this IP responds to me

* * * * *

Sending packets and receiving responses
--------------------------

ans, unans = srp(packet, timeout=2, iface=interface, inter=0.1)

- `srp()` → you sent the packet and received a response

- `timeout=2` → waits for a response for two seconds

- `iface=interface` → uses the specified network card

- `inter=0.1` → a small time between each packet

Result:

- `ans` → devices that responded

- `unans` → devices that did not respond

* * * * *

Print the results
-------------

for send, receive in ans:\
    print(receive.sprintf(r"%Ether.src% - %ARP.psrc%"))

It prints:

MAC Address - IP Address

example:

00:11:22:33:44:55 - 10.10.X.5




  
</details>




































































